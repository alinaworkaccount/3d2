<html>
<head>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script>
        function rotateTo(x, y, z) {
            const model = document.querySelector('#myModel');
            model.cameraOrbit = `${x}rad ${y}rad ${z}m`;

            // Check if GetPlayer is available and handle errors gracefully
            try {
                if (typeof GetPlayer === 'function') {
                    // Get the Storyline player object
                    var player = GetPlayer();
                    
                    // Get the value of the "changingtxt" variable from Storyline
                    var message = player.GetVar("changingtxt");
                    
                    // Log the message (optional)
                    console.log("Current changingtxt value:", message);

                    // Reassign the value of the "changingtxt" variable
                    player.SetVar("changingtxt", "goodbye");
                } else {
                    console.error("GetPlayer is not available. Make sure this is running inside Storyline.");
                }
            } catch (error) {
                console.error("Error while accessing Storyline's GetPlayer:", error);
            }
        }

        window.addEventListener('message', (event) => {
            if (event.data.type === 'rotateModel') {
                rotateTo(event.data.x, event.data.y, event.data.z);
            }
        }, false);
    </script>
</head>
<body>
    <model-viewer 
        id="myModel"
        src="https://modelviewer.dev/shared-assets/models/Astronaut.glb"
        alt="3D Model"
        style="width: 100%; height: 100%;">
    </model-viewer>
</body>
</html>
